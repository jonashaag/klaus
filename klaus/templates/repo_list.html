{% extends 'skeleton.html' %}

{% block title %}Repository list{% endblock %}

{% block content %}

<h2>
  Repositories
  <span>
    (<a href="?by-last-update=yep">order by last update</a>)
  </span>
</h2>
<ul class=repolist>
  {% for repo in repos %}
    <li>
      <a href="{{ url_for('history', repo=repo.name) }}">
        <span class=name>{{ repo.name }}</span>
        <span class=last-updated>
          {% set last_updated_at = repo.get_last_updated_at() %}
          {% if last_updated_at is not none %}
          last updated {{ last_updated_at|timesince }} ago
          {% else %}
          no commits yet
          {% endif %}
        </span>
      </a>
      <div id="{{ repo.name }}-preview" class="readme">
        {% if repo.get_readme() %}
        {{ repo.get_readme(preview=True)|safe }}
        <a href="#" onclick="document.getElementById('{{ repo.name }}-preview').style.display = 'none'; document.getElementById('{{ repo.name }}-full').style.display = '';">read more...</a>
        {% endif %}
      </div>
      <div id="{{ repo.name }}-full" class="readme" style="display: none;">
        {% if repo.get_readme() %}
        {{ repo.get_readme()|safe }}
        <a href="#" onclick="document.getElementById('{{ repo.name }}-full').style.display = 'none'; document.getElementById('{{ repo.name }}-preview').style.display = '';">read less...</a>
        {% endif %}
      </div>
    </li>
  {% endfor %}
</ul>

{% endblock %}
